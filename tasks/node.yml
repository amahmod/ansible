- name: Install n Nodejs version manager
  shell: curl -L https://raw.githubusercontent.com/mklement0/n-install/stable/bin/n-install | bash
  ignore_errors: yes
  tags: &tags_for_node ['install', 'node', 'neovim']

- name: Install Node.js 22
  shell: n install 22
  tags: *tags_for_node

- name: npmjs prefix
  file:
      path: ~/.local/.npm-packages
      state: directory
  tags: *tags_for_node

- name: npmjs global settings
  shell: npm config set prefix '~/.local/.npm-packages'
  tags: *tags_for_node

- name: add npm global to PATH
  shell: export PATH=~/.local/.npm-packages/bin:$PATH
  tags: *tags_for_node

- name: Install global npm packages
  npm:
      global: yes
      name: '{{ item }}'
  with_items:
      - n
      - nodemon
      - yarn
      - typescript
      - ts-node
      - live-server
  tags: *tags_for_node
